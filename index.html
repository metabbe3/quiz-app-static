<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Senior Technical Concepts Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .quiz-container { transition: opacity 0.5s ease-in-out; }
        .option-btn { transition: background-color 0.2s, border-color 0.2s, transform 0.1s; }
        .option-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .option-btn.selected { background-color: #3b82f6; color: white; border-color: #2563eb; }
        .timer-warning { color: #ef4444; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        pre { font-family: 'Courier New', Courier, monospace; font-size: 0.85rem; white-space: pre-wrap; word-wrap: break-word; }
        .code-snippet { background-color: #f3f4f6; border: 1px solid #e5e7eb; padding: 1rem; border-radius: 0.5rem; }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-4xl mx-auto">
        <div id="login-screen" class="bg-white p-8 rounded-xl shadow-lg quiz-container">
            <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">Senior Technical Concepts Quiz</h1>
            <p class="text-center text-gray-500 mb-8">You will have 30 minutes to complete 35 questions. Good luck!</p>
            <div class="space-y-6">
                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                    <input type="text" id="name" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="e.g., Jane Doe">
                </div>
                <div>
                    <label for="companyId" class="block text-sm font-medium text-gray-700 mb-1">Company ID</label>
                    <input type="text" id="companyId" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="e.g., EMP12345">
                </div>
                <button id="start-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700">Start Quiz</button>
            </div>
            <p id="login-error" class="text-red-500 text-center mt-4 h-4"></p>
        </div>

        <div id="quiz-screen" class="bg-white p-8 rounded-xl shadow-lg quiz-container hidden">
            <div id="quiz-header" class="flex justify-between items-center border-b pb-4 mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Question <span id="question-number"></span>/<span id="total-questions"></span></h2>
                <div id="timer" class="text-lg font-semibold text-blue-600 tabular-nums">30:00</div>
            </div>
            <div id="question-area">
                <div id="question-text" class="text-lg text-gray-800 mb-6 leading-relaxed"></div>
                <div id="code-comparison-container" class="mb-6"></div>
                <div id="options-container" class="space-y-3"></div>
            </div>
            <div class="flex justify-between mt-8">
                <button id="prev-btn" class="bg-gray-200 text-gray-700 font-bold py-2 px-6 rounded-lg hover:bg-gray-300">Previous</button>
                <button id="next-btn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700">Next</button>
            </div>
        </div>

        <div id="results-screen" class="bg-white p-8 rounded-xl shadow-lg quiz-container hidden">
            <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">Quiz Completed!</h1>
            <p class="text-center text-gray-500 mb-6">Here is your performance summary.</p>
            <div class="bg-gray-50 p-6 rounded-lg mb-6 text-center">
                <p><strong>Name:</strong> <span id="result-name"></span></p>
                <p><strong>Company ID:</strong> <span id="result-companyId"></span></p>
                <p><strong>Time Taken:</strong> <span id="result-time"></span></p>
            </div>
            <div class="flex justify-around items-center bg-blue-50 p-6 rounded-lg mb-8">
                <div><p class="text-sm text-blue-800 font-bold">SCORE</p><p class="text-4xl font-bold text-blue-600" id="score"></p></div>
                <div class="w-px bg-blue-200 h-16"></div>
                <div><p class="text-sm text-green-800 font-bold">CORRECT</p><p class="text-4xl font-bold text-green-600" id="correct-answers"></p></div>
                <div class="w-px bg-blue-200 h-16"></div>
                <div><p class="text-sm text-red-800 font-bold">INCORRECT</p><p class="text-4xl font-bold text-red-600" id="incorrect-answers"></p></div>
            </div>
            <div id="detailed-results" class="space-y-4 mb-8 max-h-96 overflow-y-auto pr-4"></div>
            <div class="flex space-x-4">
                <button id="restart-btn" class="w-full bg-gray-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-gray-700">Try Again</button>
                <button id="download-btn" class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700">Download Results</button>
            </div>
        </div>
    </div>

<script>
    // --- QUESTION BANKS ---

    const generalQuestions = [
        { type: 'mcq', question: "If a running application is a 'process', what is the best analogy for its 'threads'?", options: ["Different people living in the house, sharing the same address", "Separate, identical houses built next to each other", "The single blueprint used to build the house", "The electricity and water utilities"], answer: "Different people living in the house, sharing the same address" },
        { type: 'mcq', question: "What problem does virtual memory primarily solve?", options: ["It prevents application crashes", "It allows an app to act as if it has a vast, private memory space", "It makes physical RAM faster", "It secures the app from network attacks"], answer: "It allows an app to act as if it has a vast, private memory space" },
        { type: 'mcq', question: "A 'deadlock' is a situation where:", options: ["A process terminates unexpectedly", "Two or more processes are blocked forever, each waiting for a resource held by another", "The OS runs out of memory", "A user enters the wrong password multiple times"], answer: "Two or more processes are blocked forever, each waiting for a resource held by another"},
        { type: 'mcq', question: "While a database index speeds up data retrieval (`SELECT`), what is the trade-off?", options: ["It makes the database less secure", "It slightly slows down data modification (`INSERT`, `UPDATE`, `DELETE`)", "It can only be used on small tables", "It makes `SELECT` statements more complex"], answer: "It slightly slows down data modification (`INSERT`, `UPDATE`, `DELETE`)" },
        { type: 'mcq', question: "What does 'ACID' stand for in database transactions?", options: ["Atomicity, Consistency, Isolation, Durability", "Association, Consistency, Integration, Durability", "Atomicity, Concurrency, Isolation, Durability", "Association, Concurrency, Integration, Durability"], answer: "Atomicity, Consistency, Isolation, Durability"},
        { type: 'mcq', question: "Why is statelessness in RESTful APIs important for scalability?", options: ["The server remembers every client's previous requests", "Any server can handle any request because no session history is stored on the server", "It encrypts the application state", "It requires clients to maintain a permanent connection"], answer: "Any server can handle any request because no session history is stored on the server" },
        { type: 'mcq', question: "What is the primary purpose of a CDN (Content Delivery Network)?", options: ["To balance load across application servers", "To distribute static content to servers closer to the user for faster delivery", "To act as a central database", "To provide a secure entry point to an application"], answer: "To distribute static content to servers closer to the user for faster delivery"},
        { type: 'mcq', question: "What data structure provides the fastest average time complexity for checking the existence of an item?", options: ["Linked List", "Hash Table (or HashSet)", "Sorted Array", "Stack"], answer: "Hash Table (or HashSet)" },
    ];

    const javaQuestions = [
        { type: 'mcq', question: "What is the key difference between `==` and the `.equals()` method when comparing non-primitive objects in Java?", options: ["There is no difference", "`==` compares content, `.equals()` compares memory address", "`==` compares memory addresses, while `.equals()` is meant to compare content", "`==` is for primitives, `.equals()` is for objects"], answer: "`==` compares memory addresses, while `.equals()` is meant to compare content" },
        { type: 'mcq', question: "What is the advantage of using a `try-with-resources` statement?", options: ["It makes code run faster", "It automatically closes resources, preventing resource leaks", "It allows for more than one `catch` block", "It converts checked exceptions to unchecked exceptions"], answer: "It automatically closes resources, preventing resource leaks" },
        { type: 'mcq', question: "Which collection does not allow duplicate elements and is unordered?", options: ["ArrayList", "LinkedList", "HashSet", "TreeMap"], answer: "HashSet" },
        { type: 'mcq', question: "What is the difference between a `checked` and an `unchecked` exception in Java?", options: ["Checked exceptions must be handled at compile-time", "Unchecked exceptions are more severe", "There is no functional difference", "Checked exceptions only occur in multi-threaded code"], answer: "Checked exceptions must be handled at compile-time" },
        { type: 'mcq', question: "If a class is declared as `abstract`, what is true?", options: ["You must create an instance of it", "It cannot have any concrete (non-abstract) methods", "It cannot be instantiated directly and may contain abstract methods", "It must extend another abstract class"], answer: "It cannot be instantiated directly and may contain abstract methods" },
    ];

    const systemDesignQuestions = [
        { type: 'mcq', question: "If a primary caching layer (e.g., Redis) fails completely, what is the most critical impact on a typical web application?", options: ["The database will experience a massive increase in read load", "The application's background job processor will stop", "Users will be unable to log in", "Static assets like images will fail to load"], answer: "The database will experience a massive increase in read load" },
        { type: 'mcq', question: "In a microservices architecture, why is using a message broker for inter-service communication often better than direct HTTP calls?", options: ["It guarantees faster processing", "It ensures transactional integrity across services", "It decouples services and improves the user's response time", "It uses less server memory than HTTP"], answer: "It decouples services and improves the user's response time" },
    ];

    const codeOptimizationQuestions = [
        {
            type: 'code-comparison',
            question: "Which Java method for building a long string is more optimized, and why?",
            snippets: {
                optionA: `// Option A\npublic String buildString(String[] words) {\n    String result = "";\n    for (String word : words) {\n        result += " " + word;\n    }\n    return result;\n}`,
                optionB: `// Option B\npublic String buildString(String[] words) {\n    StringBuilder sb = new StringBuilder();\n    for (String word : words) {\n        sb.append(" ").append(word);\n    }\n    return sb.toString();\n}`
            },
            options: [
                "Option A is better because it's simpler and uses less memory.",
                "Option B is better because `StringBuilder` is mutable, avoiding the creation of many intermediate String objects.",
                "Option A is better because the `+` operator is automatically optimized by the Java compiler to be identical to `StringBuilder`.",
                "Both are equally performant for any number of words."
            ],
            answer: "Option B is better because `StringBuilder` is mutable, avoiding the creation of many intermediate String objects."
        },
        {
            type: 'code-comparison',
            question: "To fetch posts and their authors, which approach avoids the 'N+1 query problem'?",
            snippets: {
                optionA: `// Option A: Fetch posts, then loop to fetch each author\nList<Post> posts = postRepo.findAll();\nfor (Post post : posts) {\n    Author author = authorRepo.findById(post.getAuthorId());\n    post.setAuthor(author);\n}`,
                optionB: `// Option B: Fetch posts and authors in a single query\n@Query("SELECT p, a FROM Post p JOIN p.author a")\nList<Post> findPostsAndAuthors();\n\nList<Post> posts = postRepo.findPostsAndAuthors();`
            },
            options: [
                "Option A is better because it's
